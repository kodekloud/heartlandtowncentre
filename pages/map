<style>
    .main_content{
        padding-right:10px;
    }
</style>
<h1>Centre Map</h1>

<div class="store_select">
    <select id="store_select_container" onchange="javascript:map_pin(this.value)">
        <option default selected>test</option>
        <script id="store_select_template" type="x-tmpl-mustache/text">
            <option value='{{svgmap_region}}/{{slug}}'>{{name}}</option>
        </script>
    </select>
</div>




<div class="map_container" id="mapsvg"></div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js"></script>
<script type="text/javascript" src="http://assets.kodekloud.io/sites/556628266e6f640eb3000000/138b043444ee6b5e381a27b2103d101a/jquery.mousewheel.js"></script>
<script type="text/javascript" src="http://assets.kodekloud.io/sites/55ddf3f86e6f640775000000/d8c14ddd5ad7b16b08a457f92431c96c/heartland_svgmap.js"></script>


<script>
    $(document).ready(function() {
        
        
        function renderAll(){
            var stores = getStoresList();
            regions = {}
            $.each( stores , function( key, val ) {
                if(val.svgmap_region != null && typeof(val.svgmap_region)  != 'undefined'){
                    if(!val.store_front_url ||  val.store_front_url.indexOf('missing.png') > -1 || val.store_front_url.length === 0){
                        val.store_front_url = 'http://assets.kodekloud.io/sites/55ddf3f86e6f640775000000/26b24c22c6eefc98170d368721d95a80/htc_default.png'
                    } 
                    obj = {};
                    obj["popover"] = "<img src='"+val.store_front_url+"'/><p class='tooltip_name'>"+val.name+"</p> <a href='/directory/"+val.slug+"'>View Details</a>"
                    obj["attr"] = {}
                    // obj["attr"]["href"] = "/directory/"+val.slug
                    regions[val.svgmap_region] = obj
                }
            });
            renderPageData("#store_select_container","#store_select_template",stores, "stores")
            $(".loading_overlay").hide();    
            load_map(regions)
        }
        
        function load_map(reg){
            map = $('#mapsvg').mapSvg({
                source: getSVGMapURL(),    // Path to SVG map
                colors: {stroke: '#aaaaaa', selected: "#CC00CC", hover: "#CC00CC"},
                // viewBox: [3000,0,6000,6000],
                disableAll: true,
                height:800,
                width:1193,
                regions: reg,
                tooltipsMode:'custom',
                loadingText: "loading...",
                zoom: true,
                zoomButtons: {'show': true,'location': 'left' },
                pan:true,
                cursor:'pointer',
                responsive:true,
                zoomLimit: [0,10]
            });
        }
            
        
        loadMallDataCached(renderAll);  
    })
    
</script>