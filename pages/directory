<style>
    .main_content{
        padding-right:15px;
        margin-top:20px;
    }
</style>
<div class="tabs">
    <div class="tab_title" id="alpha_tab" onclick="javascript:toggle_tabs('alpha')">
        Alphabetical
    </div>
    <div class="tab_triangle" id="alpha_triangle">
        &nbsp;
    </div>
    <div class="tab_title" id="cat_tab" onclick="javascript:toggle_tabs('cat')">
        Categories
    </div>
    <div class="tab_triangle" id="cat_triangle">
        &nbsp;
    </div>
    <div class="tab_title_content" id="alpha_tab_title_content_container">
        <script id="alpha_tab_title_content_template" type="x-tmpl-mustache/text">
            <a href="#{{id}}">{{id}}</a>
        </script>
    </div>
    <div class="tab_title_content" id="cat_tab_title_content_container">
        <script id="cat_tab_title_content_template" type="x-tmpl-mustache/text">
            <a href="#cat_{{id}}">{{name}}</a>
        </script>
    </div>
</div>



<script>
    
    $("#alpha_tab").css({"color":"black","background":"#f3f3f3"})
    $("#alpha_triangle").css("border-bottom","39px solid #f3f3f3")
    function toggle_tabs(id){
        if (id == 'alpha') {
            $("#cat_tab_title_content_container").hide()
            $("#alpha_tab_title_content_container").show()
            $("#alpha_tab").css({"color":"black","background":"#f3f3f3"})
            $("#alpha_triangle").css("border-bottom","39px solid #f3f3f3")
            $("#cat_tab").css({"color":"white","background":"black"})
            $("#cat_triangle").css("border-bottom","39px solid black")
        } else {
            $("#cat_tab_title_content_container").show()
            $("#alpha_tab_title_content_container").hide()
            $("#cat_tab").css({"color":"black","background":"#f3f3f3"})
            $("#cat_triangle").css("border-bottom","39px solid #f3f3f3")
        }
    }
    $(document).ready(function() {
        function renderAll(){
            
            var alpha_stores = getStoresList();
            var full_cat_array = getStoreCategories();
            var alpha_array = generateAlphaStoreList(alpha_stores);
            
            renderPageData("#alpha_tab_title_content_container", "#alpha_tab_title_content_template", alpha_array, "directory")
            renderPageData("#cat_tab_title_content_container", "#cat_tab_title_content_template", full_cat_array, "directory")
            $("#alpha_tab_title_content_container").show();
            
            
        }
        loadMallDataCached(renderAll);  
        // loadMallData(renderAll);  
        
        
        
        
        
        function generateAlphaStoreList (collection){
            alpha_list = new Array;
            alpha_array = new Array;
             $.each( collection , function( key, val ) {
                 first_letter = (val.name).charAt(0)
                 if (jQuery.inArray(first_letter, alpha_list)== -1){
                     obj = {};
                     obj.name = first_letter
                     obj.id = first_letter
                     alpha_array.push(obj);
                     alpha_list.push(first_letter)
                 } else {
                     
                 }
             })
             
           
            
            $.each( alpha_array , function( key, val ) {
                var store_ids = []
                  $.each( collection , function( key2, val2 ) {
                      if (val.name == (val2.name).charAt(0)){
                          store_ids.push(val2.id)
                      }
                  })
                val.store_ids = store_ids
             })
            
            return(alpha_array)
        
        }
    })
</script>