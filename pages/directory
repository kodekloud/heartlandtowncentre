<div class="tabs">
    <div class="tab_title" id="alpha_tab">
        <p>Alphabetical</p>
        <div class="tab_title_content" id="alpha_tab_title_content_container">
            <script id="alpha_tab_title_content_template" type="x-tmpl-mustache/text">
                {{letter}}
            </script>
        </div>
    </div>
    <div class="tab_title" id="cat_tab">
        <p>Categories</p>
        <div class="tab_title_content" id="cat_tab_title_content_container">
            <script id="cat_tab_title_content_template" type="x-tmpl-mustache/text">
                {{name}}
            </script>
        </div>
    </div>
</div>



<script>
    $(document).ready(function() {
        function renderAll(){
            var alpha_stores = getStoresList();
            var full_cat_array = getStoreCategories();
            var alpha_array = generateAlphaStoreList(alpha_stores);
            console.log(alpha_array)
            console.log(full_cat_array)
            
        }
        // loadMallDataCached(renderAll);  
        loadMallData(renderAll);  
        
        
        function generateAlphaStoreList (collection){
            alpha_list = new Array;
            alpha_array = new Array;
             $.each( collection , function( key, val ) {
                 first_letter = (val.name).charAt(0)
                 if (jQuery.inArray(first_letter, alpha_list)== -1){
                     obj = {};
                     obj.name = first_letter
                     obj.id = first_letter
                     alpha_array.push(obj);
                     alpha_list.push(first_letter)
                 } else {
                     
                 }
             })
             
           
            
            $.each( alpha_array , function( key, val ) {
                var store_ids = []
                  $.each( collection , function( key2, val2 ) {
                      if (val.name == (val2.name).charAt(0)){
                          store_ids.push(val2.id)
                      }
                  })
                val.store_ids = store_ids
             })
            
            return(alpha_array)
        
        }
    })
</script>